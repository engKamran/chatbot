<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Live Stream Dashboard</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="admin-chatbox-container">
    <!-- Chat Header -->
    <div class="chatbox-header">
      <div class="chatbox-header-left">
        <div class="chatbox-avatar">📡</div>
        <div class="chatbox-header-info">
          <h2>Live Stream Control</h2>
          <p id="chatboxStatus" class="chatbox-status-text">
            <span class="live-badge">🔴 LIVE</span>
            <span id="statusText">Ready to stream</span>
          </p>
        </div>
      </div>
      <div class="chatbox-header-right">
        <div class="status-dot active" id="chatboxStatusDot"></div>
      </div>
    </div>

    <!-- Chat Content -->
    <div class="chatbox-content">
      <!-- Messages/Queue Area -->
      <div id="messagesArea" class="messages-area">
        <div class="message-group welcome-message">
          <div class="message-avatar">📡</div>
          <div class="message-content">
            <p><strong>Welcome to Live Stream Control!</strong></p>
            <p>🔴 You're LIVE and ready to stream!</p>
            <p>Manage your visitor queue and start streaming below.</p>
          </div>
        </div>
      </div>

      <!-- Queue Controls Section -->
      <div id="queueControlsSection" style="display: none;" class="chat-input-section">
        <div class="queue-info">
          <div class="queue-position-info">
            <p>📍 Next Visitor: <strong id="nextVisitorName">Waiting...</strong></p>
            <p class="queue-hint">👥 Queue: <strong id="queueCount">0</strong> waiting</p>
          </div>
        </div>
        <div class="controls" style="display: flex; gap: 8px; margin-top: 12px;">
          <button class="btn-success" id="acceptBtn" onclick="acceptVisitor()" style="flex: 1;">✓ Accept</button>
          <button class="btn-danger" id="rejectBtn" onclick="rejectVisitor()" style="flex: 1;">✗ Reject</button>
        </div>
      </div>

      <!-- Video Section -->
      <div id="videoSection" style="display: none;" class="chat-input-section">
        <div class="queue-info">
          <p>🎥 Streaming with: <strong id="currentVisitorName">-</strong></p>
        </div>
        <div class="video-container-chat" style="position: relative; height: 300px; margin: 12px 0;">
          <video id="localVideo" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;"></video>
          <button class="btn-fullscreen" id="fullscreenBtn" onclick="toggleFullscreen()" title="Fullscreen">⛶</button>
        </div>
      </div>

      <!-- Queue List -->
      <div id="queueSection" style="display: none;" class="chat-input-section">
        <p style="font-size: 12px; color: #666; margin: 0 0 8px 0;">📋 Visitor Queue:</p>
        <ul class="queue-list" id="queueList" style="margin: 0; padding: 0; list-style: none;">
          <li class="queue-item" style="color: #999; font-size: 12px;">No visitors in queue</li>
        </ul>
      </div>

      <!-- Hidden video element for camera initialization -->
      <video id="localVideoHidden" autoplay muted playsinline style="display: none; width: 1px; height: 1px;"></video>
    </div>

    <!-- Chat Footer -->
    <div class="chatbox-footer">
      <div id="messageBox" style="padding: 8px 16px; font-size: 12px;"></div>
      <button class="btn-danger btn-full" id="endStreamBtn" onclick="endStream()" style="display: none; margin: 8px 16px 0 16px;">End Stream</button>
    </div>
  </div>

  <!-- Hidden remote video element for admin -->
  <video id="remoteVideo" style="display: none;"></video>

  <!-- Fullscreen video container -->
  <div id="fullscreenContainer" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999;">
    <video id="fullscreenVideo" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: contain;"></video>
    <button class="btn-fullscreen-close" onclick="toggleFullscreen()" title="Exit Fullscreen">✕</button>
  </div>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script src="/js/webrtc-utils.js"></script>
  <script src="/js/admin.js"></script>
</body>
</html>

